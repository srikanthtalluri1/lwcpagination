/*Lazy Loading*/
    loadMoreData1(event) {
        console.log('scrolling loadMoreData: 678 ', event);
        const currentRecord = this.records;
        const { target } = event;
        //target.isLoading = true;
        this.rowOffSet = this.rowOffSet + this.rowLimit;
        console.log('this.rowOffSet: 684 ', this.rowOffSet);
        this.fetchData();
    }
    /*Lazy Loading*/

    /*Lazy Loading*/
    @track recordsConnected = [];
    fetchData1(applyFilterClick) {
        console.log('this.selectedWaiver in fetchData 284 ' + this.selectedWaiver);
        console.log('this.rowLimit in fetchData 284 ' + this.rowLimit);
        console.log('this.rowOffSet in fetchData 284 ' + this.rowOffSet);

        getWaiverRecords({
            searchKey: this.searchKey,
            sortBy: this.sortedBy,
            sortOrder: this.sortedDirection,
            pageSize: this.currentPageSize,
            first: this.first,
            after: this.after,
            lastId: this.lastId,
            before: this.before,
            firstId: this.firstId,
            last: this.last,
            lastPageSize: this.lastPageSize,
            allOrMy: this.selectedWaiver,
            filters: JSON.stringify(this.filters),
            tab: this.tab,
            limitSize: this.rowLimit , offset : this.rowOffSet
        }).then((data) => {
            console.log('this.initialRecords length in fetchData 300 ' + this.initialRecords);
            console.log('data.waiverRecords 300 ' + JSON.stringify(data.waiverRecords));

            /*Lazy Loading*/
            if (!data.waiverRecords || data.waiverRecords.length === 0) {
                console.log('No more records to load.');
                this.hasMoreData = false;  // Mark that no more records exist
                this.isLoading = false;
                //return;
            }
            /*Lazy Loading*/

            if (this.initialRecords.length === 0) {
                this.initialRecords = data.waiverRecords;
            }
            console.log('data in fetchData 304 ' + JSON.stringify(data));

            const filteredRecords = data.waiverRecords.filter((record) => {
                // Defining the conditions under which records should be included
                return record.Waiver_Id__r; //&& record.Waiver_Id__r.Name && record.Waiver_Id__r.Status__c;
            });

            const records = data.waiverRecords.map((record) => {
                return {
                    ...record,
                    Name: record.Waiver_Id__r?.Name ?? '',
                    Requesting_Portfolio__c: record.Waiver_Id__r?.Requesting_Portfolio__c ?? '',
                    Waiver_Reason__c: record.Waiver_Id__r?.Waiver_Reason__c ?? '',
                    Status__c: record.Waiver_Id__r?.Status__c ?? '',
                    Standard_Page_Title__c: record.Waiver_Id__r?.Standard_Page_Title__c ?? '',
                    Type__c: record.Waiver_Id__r?.Type__c ?? '',
                };
            });

            

            /*Srikanth Pagination Logic*/
            // Handling records regardless of Apex behavior
            if (this.currentPage === 1) {
                // Save all records on the first fetch
                this.allRecords = records;//data.waiverRecords;
                this.totalRecords = data.waiverRecordsCount;
                this.totalPages = Math.ceil(this.totalRecords / this.currentPageSize);
            }
            // Updating visible records for the current page

            /*Lazy Loading*/
            //this.updateVisibleRecords();
            //this.isLoading = false;
            let updatedRecords = [...this.records, ...records];
            this.records = updatedRecords;
            if (applyFilterClick == 'connectedCall') {
                this.recordsConnected = this.records;
            }
            console.log('this.recordsConnected in fetchData1 838 ' + this.recordsConnected);
            console.log('this.records lazy loading 839 ' + this.records);
            this.totalRecords = data.waiverRecordsCount;
            this.hasMoreData = this.records.length < this.totalRecords;
            //if (!this.hasMoreData) {
                this.isLoading = false;
                this.isLoadingMore = false;
            //}
            console.log('this.hasMoreData 669 ' + this.hasMoreData);
            console.log('this.isLoading 669 ' + this.isLoading);
            /*Lazy Loading*/

            //this.isLoading = false;
            // If there's no data for the current page, reset the page and fetch again
            if (this.records.length === 0 && this.currentPage > 1) {
                this.currentPage--;
                this.fetchData();
            }
            /*Srikanth Pagination Logic*/

            console.log('this.selectedWaiver 317 ' + this.selectedWaiver);
            // Publish the event with the payload
            const payload = {
                records: this.records,
                totalRecords: this.totalRecords,
                totalPages: this.totalPages,
                isLoading: this.isLoading,
                selectedWaiver: this.selectedWaiver,
                selectedFilter: this.selectedFilter
            };
            pubsub.publish('waiverRecordsFetched', payload);

        }).catch((error) => {
            console.error(error);
            this.isLoading = false;
        });
    }
    /*Lazy Loading*/
