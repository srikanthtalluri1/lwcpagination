<template>
    <div class="slds-combobox_container">
        <div class={dropdownClass}>
            <!-- Input field -->
            <div class="slds-combobox__form-element" role="none">
                <input type="text" 
                       class="slds-input slds-combobox__input" 
                       placeholder="Select filters..." 
                       value={searchKey}
                       oninput={handleSearch}
                       onclick={toggleDropdown}/>
            </div>

            <!-- Dropdown -->
            <template if:true={isDropdownOpen}>
                <div class="slds-dropdown slds-dropdown_length-5 slds-dropdown_fluid">
                    <ul class="slds-listbox slds-listbox_vertical" role="presentation">
                        <template for:each={filteredOptions} for:item="opt">
                            <li key={opt.value} role="presentation" class="slds-listbox__item">
                                <div class="slds-media slds-listbox__option slds-listbox__option_plain" role="option">
                                    <label class="slds-checkbox">
                                        <input type="checkbox" value={opt.value} checked={opt.checked} onchange={handleCheck}/>
                                        <span class="slds-checkbox_faux slds-p-right_medium"></span>
                                        <span style="padding-left: 10px;" class={opt.class}>{opt.label}</span>
                                    </label>
                                </div>
                            </li>
                        </template>
                        <template if:true={noResults}>
                            <li class="slds-listbox__item">
                                <span class="slds-p-around_small">No results found</span>
                            </li>
                        </template>
                    </ul>
                </div>
            </template>
        </div>
    </div>
</template>

import { LightningElement, track, api } from 'lwc';
export default class TechnologyDecisionCustomPick extends LightningElement {

    @track isDropdownOpen = false;
    @track searchKey = '';
    @track options = [
        { label: 'Name', value: 'Name', checked: false, class: 'slds-form-element__label' },
        { label: 'Status', value: 'Status', checked: false, class: 'slds-form-element__label' },
        { label: 'Decision Reason', value: 'Decision Reason', checked: false, class: 'slds-form-element__label' }
        
    ];

    get dropdownClass() {
        return `slds-combobox slds-dropdown-trigger slds-dropdown-trigger_click ${this.isDropdownOpen ? 'slds-is-open' : ''}`;
    }

    get filteredOptions() {
        if (!this.searchKey) return this.options;
        return this.options.filter(opt =>
            opt.label.toLowerCase().includes(this.searchKey.toLowerCase())
        );
    }

    get noResults() {
        return this.filteredOptions.length === 0;
    }

    toggleDropdown() {
        this.isDropdownOpen = !this.isDropdownOpen;
    }

    handleSearch(event) {
        this.searchKey = event.target.value;
        this.isDropdownOpen = true;
    }

    handleCheck(event) {
        const { value, checked } = event.target;
        this.options = this.options.map(opt =>
            opt.value === value
                ? { ...opt, checked, class: checked ? 'slds-form-element__label slds-text-title_bold' : 'slds-form-element__label' }
                : opt
        );
    }
}


.slds-combobox__form-element {
    min-height: 2.5rem;
    display: flex;
    align-items: center;
}
.slds-pill_container {
    display: flex;
    flex-wrap: wrap;
    gap: 0.25rem;
}
.slds-combobox_container {
    width: 300px;
}


