 Integer maxQueriesAllowed = Limits.getLimitQueries() - Limits.getQueries(); // Just for safety

/*for (String field : fieldApiName) {
    if (!fieldList.containsKey(field)) continue;

    if (Limits.getQueries() < maxQueriesAllowed) {
        String query = '';

        if (fieldList.get(field) == 'Affected_Standard_Portfolio1__c') {
            query = 'SELECT Affected_Standard_Portfolio1__c,Affected_Standard_Portfolio1__r.Name, COUNT(Id) ' +
                    'FROM AWP_Waiver_Relationship__c ' + condition +
                    ' GROUP BY Affected_Standard_Portfolio1__c,Affected_Standard_Portfolio1__r.Name';
        } else {
            query = 'SELECT ' + fieldList.get(field) + ', COUNT(Id) ' +
                    'FROM AWP_Waiver_Relationship__c ' + condition +
                    ' GROUP BY ' + fieldList.get(field);
        }

        results.put(field, Database.query(query));
    } else {
        // Optional: Log or handle case when you're about to exceed limits
        System.debug('Skipping query for field: ' + field + ' to avoid governor limits.');
    }
} */
        //Srikant 9 April to write query out of for loop
        /*Set<String> fieldsToReplace = new Set<String>{
          'Waiver_Reason__c', 
              'Requesting_Portfolio__c', 
              'Status__c', 
              'Standard_Page_Title__c',
              'Type__c',
              'Stage__c'
              }; 
		 'Requesting Application' => 'Requesting_Application__c',
    'Affected Standard' => 'Affected_Standard_Portfolio1__c',
    'BARR Risk Level' => 'Waiver_Id__r.BARR_Risk_Level_UI__c',
    'Waiver Reason' => 'Waiver_Id__r.Waiver_Reason__c',
    'Status' => 'Waiver_Id__r.Status__c',
    'Type' => 'Waiver_Id__r.Type__c'*/
        String query = '';
        string fieldApiNameString = string.join(fieldApiName,',');
        if(fieldApiNameString.contains('Affected Standard')){
            query = 'SELECT Affected_Standard_Portfolio1__c,Affected_Standard_Portfolio1__r.Name, COUNT(Id) ' +
                    'FROM AWP_Waiver_Relationship__c ' + condition +
                    ' GROUP BY Affected_Standard_Portfolio1__c,Affected_Standard_Portfolio1__r.Name';
            results.put('Affected Standard', Database.query(query));
        }
        if(fieldApiNameString.contains('Requesting Application')){
            query = 'SELECT Requesting_Application__c, COUNT(Id) ' +
                    'FROM AWP_Waiver_Relationship__c ' + condition +
                    ' GROUP BY Requesting_Application__c' ;
            results.put('Requesting Application', Database.query(query));
        }
        if(fieldApiNameString.contains('BARR Risk Level')){
            query = 'SELECT Waiver_Id__r.BARR_Risk_Level_UI__c, COUNT(Id) ' +
                    'FROM AWP_Waiver_Relationship__c ' + condition +
                    ' GROUP BY Waiver_Id__r.BARR_Risk_Level_UI__c' ;
            results.put('BARR Risk Level', Database.query(query));
        }
        if(fieldApiNameString.contains('Waiver Reason')){
            query = 'SELECT Waiver_Id__r.Waiver_Reason__c, COUNT(Id) ' +
                    'FROM AWP_Waiver_Relationship__c ' + condition +
                    ' GROUP BY Waiver_Id__r.Waiver_Reason__c' ;
            results.put('Waiver Reason', Database.query(query));
        }
        if(fieldApiNameString.contains('Status')){
            query = 'SELECT Waiver_Id__r.Status__c, COUNT(Id) ' +
                    'FROM AWP_Waiver_Relationship__c ' + condition +
                    ' GROUP BY Waiver_Id__r.Status__c' ;
             results.put('Status', Database.query(query));
        }
        if(fieldApiNameString.contains('Type')){
            query = 'SELECT Waiver_Id__r.Type__c, COUNT(Id) ' +
                    'FROM AWP_Waiver_Relationship__c ' + condition +
                    ' GROUP BY Waiver_Id__r.Type__c' ;
             results.put('Type', Database.query(query));
        }
