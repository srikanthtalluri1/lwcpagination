static Map<String, Schema.SObjectType> gd = Schema.getGlobalDescribe();

    // ---------- Dynamic test-factory helpers ----------
    // Make TDTestData an outer helper (not static methods inside inner class)
    private class TDTestData {

        Boolean exists(String objApi) {
            return gd.containsKey(objApi);
        }

        Id upsertDyn(String objApi, Map<String, Object> fields) {
            if (!exists(objApi)) return null;
            SObject sob = gd.get(objApi).newSObject();
            for (String k : fields.keySet()) sob.put(k, fields.get(k));
            insert sob;
            return sob.getId();
        }

        Id makeRelation(Id domainId, Id techId, Id appId, Id platformId, Map<String, Object> extra) {
            if (!exists('TechnologyDecision_Relationship__c')) return null;
            Map<String, Object> f = new Map<String, Object>{
                'Requesting_Domain__c'      => domainId,
                'Requesting_Technology__c'  => techId,
                'Requesting_Application__c' => appId,
                'Requesting_Platform__c'    => platformId
            };
            if (extra != null) f.putAll(extra);
            return upsertDyn('TechnologyDecision_Relationship__c', f);
        }

        Id makeDecision(Map<String,Object> f) {
            return upsertDyn('TechnologyDecision__c', f);
        }

        Id makeApproval(Map<String,Object> f) {
            return upsertDyn('TechnologyDecision_Approval__c', f);
        }

        Id makeDomain(Map<String,Object> f)   { return upsertDyn('TPM_Domain__c', f); }
        Id makeApp(Map<String,Object> f)      { return upsertDyn('TPM_App__c', f); }
        Id makePlatform(Map<String,Object> f) { return upsertDyn('TPM_Platform__c', f); }

        Id makeEmployee(String name) {
            if (!exists('AWP_Employee__c')) return null;
            return upsertDyn('AWP_Employee__c', new Map<String,Object>{ 'Name' => name });
        }
    }
}
